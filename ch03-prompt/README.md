# Getting Started

## ì‚¬ì „ ì‘ì—… ìˆœì„œ 

1. ch01-spring-ai-project í”„ë¡œì íŠ¸ë¥¼ ë³µì‚¬í•˜ì—¬ ch03-promptë¡œ ë¶™ì—¬ë„£ëŠ”ë‹¤.

2. chunk ê´€ë ¨ ê¸°ëŠ¥ì€ ì‚­ì œí•©ë‹ˆë‹¤ 
```
src í´ë”ì— ìˆëŠ” chunk í´ë”ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤ 
resources/templates/chunk í´ë”ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤ 
```
3. src/main/resources/applications.properties íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤ 
```
#spring.application.name=ch01-spring-ai-project
spring.application.name=ch03-prompt

...

```

4. settings.gradle ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤ 
```
rootProject.name = 'ch03-prompt'
```

5. HelloController.java íŒŒì¼ì„ HomeController.javaë¡œ ë³€ê²½í•©ë‹ˆë‹¤

6. HomeController.java íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤ 
```
package com.example.demo.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

@Controller
public class HomeController {

    @GetMapping("/")
    public String home() {
        return "home";
    }

    // ì´ URLì€ prompt-template ì‹¤í–‰ì„ ìœ„í•œ ì—”ë“œí¬ì¸íŠ¸ì…ë‹ˆë‹¤
    @GetMapping("/prompt-template")
    public String promptTemplate() {
        return "prompt-template";
    }  

}

```

7. resources/templates/home.html íŒŒì¼ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤ 
```
<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spring AI</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>
	<div class="d-flex flex-column vh-100">
	  <div id="headPanel" class="navbar justify-content-between">
	    <a href="/" class="navbar-brand ps-2">
	      <img src="/image/spring_ai_logo_with_text.svg" width="200" />
	    </a>>
	  </div>	
	
	  <div class="card m-2">
			<div class="card-header">
				Ch03. í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§
			</div>
			<div class="card-body">
				<a href="/prompt-template" class="btn btn-info btn-sm m-1">prompt-template</a>
			</div>
	  </div>
	</div>
</body>

</html>
```

8. resources/templates/prompt-template.html íŒŒì¼ ì•„ë˜ì™€ ê°™ì´ ìˆ˜ì •í•©ë‹ˆë‹¤
   - ch01ì—ì„œ ì§„í–‰í•œ home.html íŒŒì¼ì„ prompt-template.htmlìœ¼ë¡œ ë³µì‚¬í•©ë‹ˆë‹¤ 
   

9. ìœ„ ì‘ì—…ì´ ì™„ë£Œëœ ê²ƒì€ git ì´ë ¥ì€ [3ì¥ ì‘ì—…ì„ ì‹œì‘í•˜ê¸° ìœ„í•´ ì´ˆê¸°ì„¤ì •]ì„ checkoutí•˜ì—¬ ì‘ì—…ì€ ì§„í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤ 

10. ì‹¤í–‰ í•˜ì—¬ í…ŒìŠ¤íŠ¸ í•´ë´…ë‹ˆë‹¤ 

    ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— http://localhost:8080/ì„ ì‹¤í–‰í•˜ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì¶œë ¥ë©ë‹ˆë‹¤ 

    ![alt text](image.png)

    prmopt template ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì•„ë˜ì™€ ê°™ì´ ì‹¤í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ 

    ![alt text](image-1.png)

---

## PromptTemplate í´ë˜ìŠ¤ë€ 

PromptTemplate: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ 'AI ì§ˆë¬¸ ì–‘ì‹'

PromptTemplateì„ í•œë§ˆë””ë¡œ ì •ì˜í•˜ë©´, ìì£¼ ì‚¬ìš©í•˜ëŠ” AI ì§ˆë¬¸ì˜ 'í‹€' ë˜ëŠ” 'ì–‘ì‹(Template)'ì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

  ê°€ì¥ ì‰¬ìš´ ì˜ˆë¡œ, ìš°ë¦¬ê°€ í”íˆ ì“°ëŠ” 'ë©”ì¼ ì–‘ì‹'ì„ ìƒê°í•´ ë³´ì„¸ìš”.

> ì œëª©: {ê³ ê°ëª…}ë‹˜, ë¬¸ì˜í•˜ì‹  ë‚´ìš©ì— ëŒ€í•œ ë‹µë³€ì…ë‹ˆë‹¤.

>

> ì•ˆë…•í•˜ì„¸ìš”, {ê³ ê°ëª…}ë‹˜.

> ë¬¸ì˜í•˜ì‹  {ë¬¸ì˜ì£¼ì œ} ê±´ì— ëŒ€í•´ ë‹µë³€ë“œë¦½ë‹ˆë‹¤.

> ...

> ë‹´ë‹¹ì: {ë‹´ë‹¹ìëª…} ë“œë¦¼


  ì´ ë©”ì¼ ì–‘ì‹ë§Œ ìˆìœ¼ë©´, ìš°ë¦¬ëŠ” {ê³ ê°ëª…}, {ë¬¸ì˜ì£¼ì œ}, {ë‹´ë‹¹ìëª…} ë¶€ë¶„ë§Œ ê³„ì† ë°”ê¿”ê°€ë©´ì„œ ìˆ˜ë§ì€ ê³ ê°ì—ê²Œ ë©”ì¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§¤ë²ˆ ë˜‘ê°™ì€ ë¬¸ì¥ì„ ì²˜ìŒë¶€í„° ëê¹Œì§€ ì‘ì„±í•  í•„ìš”ê°€ ì—†ì£ .

  PromptTemplateì´ ë°”ë¡œ ì´ëŸ° ì—­í• ì„ í•©ë‹ˆë‹¤. AIì—ê²Œ ë³´ë‚¼ í”„ë¡¬í”„íŠ¸(ìš”ì²­ë¬¸)ì˜ ê³ ì •ëœ ë¶€ë¶„ì€ 'í‹€'ë¡œ ë§Œë“¤ì–´ë‘ê³ , ê³„ì† ë°”ë€ŒëŠ” ë¶€ë¶„ì€ `{ë³€ìˆ˜}` í˜•íƒœì˜ 'ë¹ˆì¹¸'ìœ¼ë¡œ ë‚¨ê²¨ë‘ëŠ” ê²ƒì…ë‹ˆë‹¤.

  ---

  ì™œ PromptTemplateì„ ì‚¬ìš©í• ê¹Œìš”?

  AIì—ê²Œ ë¹„ìŠ·í•œ íŒ¨í„´ì˜ ì§ˆë¬¸ì„ ë°˜ë³µì ìœ¼ë¡œ í•´ì•¼ í•  ë•Œ, PromptTemplateì„ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì—„ì²­ë‚œ ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.

   * ì¬ì‚¬ìš©ì„±: ë˜‘ê°™ì€ í”„ë¡¬í”„íŠ¸ êµ¬ì¡°ë¥¼ ê³„ì† ì¬ì‚¬ìš©í•  ìˆ˜ ìˆì–´ ì½”ë“œ ì¤‘ë³µì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤.
   * ê°€ë…ì„±: í”„ë¡¬í”„íŠ¸ì˜ ì „ì²´ êµ¬ì¡°ì™€ ê·¸ ì•ˆì—ì„œ ì–´ë–¤ ë¶€ë¶„ì´ ë™ì ìœ¼ë¡œ ë°”ë€ŒëŠ”ì§€ í•œëˆˆì— íŒŒì•…í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.
   * ìœ ì§€ë³´ìˆ˜: ë‚˜ì¤‘ì— í”„ë¡¬í”„íŠ¸ì˜ ë¬¸êµ¬ë¥¼ ìˆ˜ì •í•´ì•¼ í•  ë•Œ, ì–‘ì‹(Template) í•œ êµ°ë°ë§Œ ê³ ì¹˜ë©´ ë˜ë¯€ë¡œ ìœ ì§€ë³´ìˆ˜ê°€ ë§¤ìš° í¸ë¦¬í•´ì§‘ë‹ˆë‹¤.

  ---

  ê°€ì¥ ì§ê´€ì ì¸ ì˜ˆì œ: 'Ní–‰ì‹œ ì§“ê¸°' AI

  AIì—ê²Œ íŠ¹ì • ì£¼ì œë¡œ Ní–‰ì‹œë¥¼ ì§“ê²Œ í•˜ëŠ” ê¸°ëŠ¥ì„ ë§Œë“ ë‹¤ê³  ìƒìƒí•´ ë´…ì‹œë‹¤. ì´ë•Œ AIì—ê²Œ ë³´ë‚´ëŠ” ìš”ì²­ì€ í•­ìƒ ë¹„ìŠ·í•œ êµ¬ì¡°ë¥¼ ê°€ì§ˆ ê²ë‹ˆë‹¤.

  > "ë„ˆëŠ” Ní–‰ì‹œì˜ ëŒ€ê°€ì•¼. {ì£¼ì œ} ë¼ëŠ” ë‹¨ì–´ë¡œ {í–‰ìˆ˜}í–‰ì‹œë¥¼ ì§€ì–´ì¤˜."

  ì´ êµ¬ì¡°ë¥¼ PromptTemplateìœ¼ë¡œ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.

1ë‹¨ê³„: 'ì§ˆë¬¸ ì–‘ì‹' ë§Œë“¤ê¸°

ë¨¼ì €, ë°”ë€ŒëŠ” ë¶€ë¶„ì¸ {ì£¼ì œ}ì™€ {í–‰ìˆ˜}ë¥¼ ë¹ˆì¹¸ìœ¼ë¡œ ë‘” 'ì§ˆë¬¸ ì–‘ì‹'(PromptTemplate)ì„ ë§Œë“­ë‹ˆë‹¤.

```
import org.springframework.ai.chat.prompt.PromptTemplate;
import java.util.Map;

// 1. {ì£¼ì œ}ì™€ {í–‰ìˆ˜}ë¥¼ ë¹ˆì¹¸ìœ¼ë¡œ ë‘” í”„ë¡¬í”„íŠ¸ 'ì–‘ì‹'ì„ ì •ì˜í•©ë‹ˆë‹¤.
String templateText = "ë„ˆëŠ” Ní–‰ì‹œì˜ ëŒ€ê°€ì•¼. '{topic}' ì´ë¼ëŠ” ë‹¨ì–´ë¡œ '{lines}'í–‰ì‹œë¥¼ ì§€ì–´ì¤˜.";
PromptTemplate promptTemplate = new PromptTemplate(templateText);
```
2ë‹¨ê³„: 'ë¹ˆì¹¸'ì— ì±„ì›Œ ë„£ì„ ë‚´ìš© ì¤€ë¹„í•˜ê¸°

ì´ì œ {topic}ê³¼ {lines}ë¼ëŠ” ë¹ˆì¹¸ì— ë“¤ì–´ê°ˆ ì‹¤ì œ ê°’ë“¤ì„ Mapì´ë¼ëŠ” ë°ì´í„° êµ¬ì¡°ì— ë‹´ì•„ ì¤€ë¹„í•©ë‹ˆë‹¤.
```
// 2. 'topic' ë¹ˆì¹¸ì—ëŠ” "ìŠ¤í”„ë§"ì„, 'lines' ë¹ˆì¹¸ì—ëŠ” "2"ë¥¼ ì±„ì›Œ ë„£ì„ ì¤€ë¹„ë¥¼ í•©ë‹ˆë‹¤.
Map<String, Object> variables = Map.of(
     "topic", "ìŠ¤í”„ë§",
     "lines", 2
 );
```   
  ì¤‘ìš”: Mapì˜ key("topic", "lines")ëŠ” ì–‘ì‹ì— ìˆë˜ {**ë¹ˆì¹¸**}ì˜ **ì´ë¦„**ê³¼ **ì •í™•íˆ ì¼ì¹˜**í•´ì•¼ í•©ë‹ˆë‹¤.

  3ë‹¨ê³„: ì–‘ì‹ì— ë‚´ìš©ì„ ì±„ì›Œ 'ì™„ì„±ëœ ì§ˆë¬¸' ë§Œë“¤ê¸°

  ì¤€ë¹„ëœ ì–‘ì‹(promptTemplate)ê³¼ ë‚´ìš©ë¬¼(variables)ì„ í•©ì³ì„œ AIì—ê²Œ ë³´ë‚¼ ìµœì¢… 'ì™„ì„±ëœ ì§ˆë¬¸'(Prompt)ì„
  ë§Œë“­ë‹ˆë‹¤. ì´ ê³¼ì •ì„ 'ë Œë”ë§(rendering)'ì´ë¼ê³  í•©ë‹ˆë‹¤.
```
// 3. ì–‘ì‹(template)ì— ë‚´ìš©(variables)ì„ ì±„ì›Œì„œ ìµœì¢… í”„ë¡¬í”„íŠ¸ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
Prompt finalPrompt = promptTemplate.create(variables);
```

4ë‹¨ê³„: ê²°ê³¼ í™•ì¸

finalPrompt ì•ˆì—ëŠ” ì–´ë–¤ ë‚´ìš©ì´ ë“¤ì–´ìˆì„ê¹Œìš”? create ë©”ì†Œë“œê°€ {topic}ê³¼ {lines}ë¥¼ ìš°ë¦¬ê°€ ì¤€ë¹„í•œ ê°’ìœ¼ë¡œ ëª¨ë‘ ë°”ê¿”ì¹˜ê¸°í•´ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì™„ì„±ëœ ì§ˆë¬¸ì„ ë§Œë“¤ì–´ ì¤ë‹ˆë‹¤.

```
// finalPrompt.getContents() ë¥¼ ì¶œë ¥í•´ë³´ë©´ ë‚˜ì˜¤ëŠ” ìµœì¢… ì§ˆë¬¸ ë‚´ìš©
```
"ë„ˆëŠ” Ní–‰ì‹œì˜ ëŒ€ê°€ì•¼. 'ìŠ¤í”„ë§' ì´ë¼ëŠ” ë‹¨ì–´ë¡œ '2'í–‰ì‹œë¥¼ ì§€ì–´ì¤˜."

ì´ì œ ì´ finalPromptë¥¼ ChatClientë‚˜ ChatModelì— ë„˜ê²¨ì£¼ê¸°ë§Œ í•˜ë©´ AIê°€ 2í–‰ì‹œë¥¼ ì§€ì–´ì£¼ê² ì£ !

ì¬ì‚¬ìš©ì„±ì˜ ë§ˆë²•:

ë§Œì•½ 3í–‰ì‹œë¥¼ ì§“ê³  ì‹¶ë‹¤ë©´? ì–‘ì‹ì„ ë˜ ë§Œë“¤ í•„ìš” ì—†ì´, ë‚´ìš©ë¬¼ë§Œ ë°”ê¿”ì„œ ì¬ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤.
```
// ë‚´ìš©ë¬¼ë§Œ ë°”ê¿”ì„œ ì–‘ì‹ì„ ì¬ì‚¬ìš©!
Map<String, Object> variables2 = Map.of(
    "topic", "ì¸ê³µì§€ëŠ¥",
    "lines", 3
);

// ë˜‘ê°™ì€ promptTemplateì„ ì‚¬ìš©í•´ì„œ ìƒˆë¡œìš´ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±
Prompt finalPrompt2 = promptTemplate.create(variables2);

// ê²°ê³¼: "ë„ˆëŠ” Ní–‰ì‹œì˜ ëŒ€ê°€ì•¼. 'ì¸ê³µì§€ëŠ¥' ì´ë¼ëŠ” ë‹¨ì–´ë¡œ '3'í–‰ì‹œë¥¼ ì§€ì–´ì¤˜."
```

í•µì‹¬ ì •ë¦¬:

PromptTemplateì€ ë°˜ë³µë˜ëŠ” AI ìš”ì²­ë¬¸ì„ 'ì–‘ì‹'ìœ¼ë¡œ ë§Œë“¤ì–´ë‘ê³ , ê·¸ ì•ˆì˜ 'ë¹ˆì¹¸'ë§Œ ë°”ê¿” ë¼ì›Œê°€ë©° íš¨ìœ¨ì ìœ¼ë¡œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•˜ê²Œ í•´ì£¼ëŠ” ë§¤ìš° ìœ ìš©í•œ ë„êµ¬ì…ë‹ˆë‹¤.

---

### ì™œ SystemPromptTemplateì„ ì‚¬ìš©í• ê¹Œìš”?

AIì—ê²Œ ì—­í• ì„ ë¶€ì—¬í•˜ëŠ” 'ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸'ì™€ ì‚¬ìš©ìì˜ 'ì§ˆë¬¸ í”„ë¡¬í”„íŠ¸'ë¥¼ ë¶„ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.

* ì—­í• ê³¼ ì§ˆë¬¸ì˜ ë¶„ë¦¬: AIì˜ ì •ì²´ì„±(ì˜ˆ: "ë„ˆëŠ” ë²ˆì—­ê°€ì•¼")ê³¼ ì‚¬ìš©ìì˜ ì§ˆë¬¸("ì´ê²ƒì„ ë²ˆì—­í•´ ì¤˜")ì„ ëª…í™•íˆ ë‚˜ëˆŒ ìˆ˜ ìˆì–´ ì½”ë“œê°€ ê¹”ë”í•´ì§‘ë‹ˆë‹¤.

* ë™ì ì¸ ì—­í•  ë¶€ì—¬: ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ìì²´ë„ í…œí”Œë¦¿ìœ¼ë¡œ ë§Œë“¤ë©´, AIì˜ ì—­í• ì„ ë™ì ìœ¼ë¡œ ê³„ì† ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì˜ˆ: {ì–¸ì–´} ë²ˆì—­ê°€, {ì§ì—…} ì „ë¬¸ê°€)

---

### ì‹œë‚˜ë¦¬ì˜¤: 'ë‹¤êµ­ì–´ ë²ˆì—­ê¸°' AI ë§Œë“¤ê¸°

ì´ë²ˆì—ëŠ” AIë¥¼ 'ì§€ì •í•œ ì–¸ì–´ë¡œ ë²ˆì—­í•´ ì£¼ëŠ” ë²ˆì—­ê¸°'ë¡œ ë§Œë“œëŠ” ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‚¬ìš©í•˜ê² ìŠµë‹ˆë‹¤.

   * ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì–‘ì‹: "ë‹µë³€ì„ ìƒì„±í•  ë•Œ HTMLì™€ CSSë¥¼ ì‚¬ìš©í•´ì„œ íŒŒë€ ê¸€ìë¡œ ì¶œë ¥í•˜ì„¸ìš”.<span> íƒœê·¸ ì•ˆì— ë“¤ì–´ê°ˆ ë‚´ìš©ë§Œ ì¶œë ¥í•˜ì„¸ìš”."
   * ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ ì–‘ì‹: "ë‹¤ìŒ í•œêµ­ì–´ ë¬¸ì¥ì„ {language}ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”.\n ë¬¸ì¥: {statement}"

ì´ì œ ì´ ë‘ ê°€ì§€ í…œí”Œë¦¿ì„ ì¡°í•©í•˜ëŠ” 3ê°€ì§€ ë°©ë²•ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

í…œí”Œë¦¿ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

    1. ê°€ì¥ ê¸°ë³¸ì ì¸ ìˆ˜ë™ ë°©ì‹ (ê°ê°ì˜ ë©”ì‹œì§€ë¥¼ ìƒì„± í›„ ì¡°í•©)
    2. PromptTemplat.createMessage() ë©”ì†Œë“œë¥¼ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±ë°©ë²•ì„ í™•ì¸
    3. ChatClientì˜ prompt(), messages() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•  
    4. ChatClientì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ì„¸ë ¨ëœ ë°©ì‹ (.system()ê³¼ .user() í™œìš©)

---
### 1. PromptTemplateì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ êµ¬ì¡° 
```
@Service
@Slf4j
public class AiServicePromptTemplate {
  // ##### í•„ë“œ #####
  private ChatClient chatClient;
  
  // 1. ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ì„ ì •ì˜í•©ë‹ˆë‹¤.
  private PromptTemplate systemTemplate = SystemPromptTemplate.builder()
      .template("""
          ë‹µë³€ì„ ìƒì„±í•  ë•Œ HTMLì™€ CSSë¥¼ ì‚¬ìš©í•´ì„œ íŒŒë€ ê¸€ìë¡œ ì¶œë ¥í•˜ì„¸ìš”.
          <span> íƒœê·¸ ì•ˆì— ë“¤ì–´ê°ˆ ë‚´ìš©ë§Œ ì¶œë ¥í•˜ì„¸ìš”.
          """)
      .build();  

  // 2. ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ì„ ì •ì˜í•©ë‹ˆë‹¤.  
  private PromptTemplate userTemplate = PromptTemplate.builder()
      .template("ë‹¤ìŒ í•œêµ­ì–´ ë¬¸ì¥ì„ {language}ë¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”.\n ë¬¸ì¥: {statement}")
      .build();

  // ##### ìƒì„±ì #####
  public AiServicePromptTemplate(ChatClient.Builder chatClientBuilder) {
    chatClient = chatClientBuilder.build();
  }
}
```

### 1. ê°€ì¥ ê¸°ë³¸ì ì¸ ìˆ˜ë™ ë°©ì‹ (ê°ê°ì˜ ë©”ì‹œì§€ë¥¼ ìƒì„± í›„ ì¡°í•©)
PromptTemplate.create()ì„ ì‚¬ìš©í•˜ì—¬ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
```
  // ##### ë©”ì†Œë“œ #####
  public Flux<String> promptTemplate1(String statement, String language) {    
    
    //PrompTemplate(userPrompt)ë¡œ promptë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    //ìƒì„±ì‹œ ë°”ì¸ë”© ë°ì´í„°ë¡œ statement, languageë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤   
    Prompt prompt = userTemplate.create(
        Map.of("statement", statement, "language", language));

    //ChatClientì˜ prompt() ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•  ë•Œ prompt ë§¤ê°œê°’ì„ ì „ë‹¬í•˜ì˜€ìŠµë‹ˆë‹¤. 
    //ì‹¤ì œë¡œ ë‚´ë¶€ì ìœ¼ë¡œ ì „ë‹¬ë˜ëŠ” ê²ƒì€ userTemplate ì…ë‹ˆë‹¤ 
    Flux<String> response = chatClient.prompt(prompt)
        .stream()
        .content();

    return response;
  }
```

ìœ„ ë°©ë²•ì€ ê°„ë‹¨í•˜ê²Œ userTemplateë§Œ ì‚¬ìš©í•˜ì—¬ LLMì„ í˜¸ì¶œí•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤


---
### AiControllerPromptTemplate í´ë˜ìŠ¤ì—ì„œ AiServicePromptTemplate ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©
```
package com.example.demo.controller;

import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;

import com.example.demo.service.AiServicePromptTemplate;

import lombok.extern.slf4j.Slf4j;
import reactor.core.publisher.Flux;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.MediaType;
import org.springframework.web.bind.annotation.PostMapping;

@RestController
@RequestMapping("/ai")
@Slf4j
public class AiControllerPromptTemplate {

    // ##### í•„ë“œ #####
    @Autowired
    private AiServicePromptTemplate aiService;

    // ##### ìš”ì²­ ë§¤í•‘ ë©”ì†Œë“œ #####
    @PostMapping(value = "/prompt-template", 
    consumes = MediaType.APPLICATION_FORM_URLENCODED_VALUE,
    produces = MediaType.APPLICATION_NDJSON_VALUE)
    public Flux<String> promptTemplate(
        @RequestParam("statement") String statement,
        @RequestParam("language") String language
        ) {
        return aiService.promptTemplate1(statement, language);
    }
    
}

```
---

### prompt-template.htmlì— ì–¸ì–´ ì„ íƒUIì™€ /prompt-template ì—”ë“œí¬ì¸íŠ¸ë¥¼ í˜¸ì¶œ í•  ìˆ˜ ìˆê²Œ ìˆ˜ì •í•¨ 
ì–¸ì–´ ì„ íƒUI ì¶”ê°€ 
```
...
    <div id="inputPanel" class="bg-secondary-subtle">
      <!-- ì–¸ì–´ ì„ íƒ ì‹œì‘ -->
      <div class="input-group p-2">
        <span class="input-group-text">ì–¸ì–´</span>
        <select id="language" class="form-control">
          <option value="ë…ì¼ì–´">ë…ì¼ì–´</option>
          <option value="ì¤‘êµ­ì–´">ì¤‘êµ­ì–´</option>
          <option value="ì¼ë³¸ì–´">ì¼ë³¸ì–´</option>
          <option value="ì˜ì–´" selected>ì˜ì–´</option>
        </select>
      </div>
      <!-- ì–¸ì–´ ì„ íƒ ë -->
      <!-- ì§ˆë¬¸ ì…ë ¥ íŒ¨ë„ ì‹œì‘ -->
      <div class="input-group p-2">
        <span class="input-group-text">ì§ˆë¬¸</span>
...
```

/prompt-template ì—”ë“œí¬ì¸íŠ¸ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê²Œ ìˆ˜ì •
```
...
      try {
        // í…ìŠ¤íŠ¸ ì§ˆë¬¸ì„ ì–»ê³  ëŒ€í™” íŒ¨ë„ì— ì¶”ê°€í•˜ê¸°
        const question = document.getElementById("question").value;
        if (question === "") return;
        springai.addUserQuestion(question, "chatPanel");

        // ì‘ë‹µì´ ì˜¤ê¸°ê¹Œì§€ ìŠ¤í”¼ë„ˆ ë³´ì—¬ì£¼ê¸°
        springai.setSpinner("spinner", true);

        // AJAX ìš”ì²­í•˜ê³  ì‘ë‹µë°›ê¸°
        const language = document.getElementById("language").value;
        const response = await fetch('/ai/prompt-template', {
          method: "post",
					headers: {
						'Content-Type': 'application/x-www-form-urlencoded',
						'Accept': 'application/x-ndjson' //ë¼ì¸ìœ¼ë¡œ êµ¬ë¶„ëœ ì²­í¬ ë°ì´í„°
					},					
          body: new URLSearchParams({ "statement":question, language })
        });
        // AI ëª¨ë¸ ë‹µë³€ì´ ë“¤ì–´ê°ˆ ìœ„ì¹˜ë¥¼ ëŒ€í™” íŒ¨ë„ì— ì¶”ê°€
        const uuid = springai.addAnswerPlaceHolder("chatPanel");
        
        // í…ìŠ¤íŠ¸ ë‹µë³€ ì¶œë ¥í•˜ê¸°
        springai.printAnswerStreamText(response.body, uuid, "chatPanel");

      } catch (error) {
        console.log(error);
      } finally {
        //ìŠ¤í”¼ë„ˆ ìˆ¨ê¸°ê¸°
        springai.setSpinner("spinner", false);
      }
...
```
---
### ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ í•˜ì—¬ í…ŒìŠ¤íŠ¸ í•´ë³´ê¸° 

    ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— http://localhost:8080/prompt-templateì„ ì‹¤í–‰í•˜ê³  ì–¸ì–´ë¥¼ ë³€ê²½ í•˜ê³  ì œì¶œì„ í•˜ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì¶œë ¥ë©ë‹ˆë‹¤ 

    ![alt text](image-2.png)

---
### PromptTemplat.createMessage() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±ë°©ë²•ì„ í™•ì¸ 
```
// ##### ë©”ì†Œë“œ #####
public Flux<String> promptTemplate2(String statement, String language) {    
  // 1. ê° í…œí”Œë¦¿ì˜ ë¹ˆì¹¸ì„ ì±„ìš¸ ê°’ë“¤ì„ Mapìœ¼ë¡œ ì¤€ë¹„í•©ë‹ˆë‹¤.
  Map<String, Object> userVariables = Map.of("statement", statement, "language", language);

  // 2. ê° í…œí”Œë¦¿ì„ Message ê°ì²´ë¡œ ë Œë”ë§í•©ë‹ˆë‹¤.
  //    ì£¼ì˜: .create()ê°€ ì•„ë‹Œ .createMessage()ë¥¼ ì‚¬ìš©í•´ì•¼ Message íƒ€ì…ìœ¼ë¡œ ë°˜í™˜ë©ë‹ˆë‹¤.
  Message systemMessage = systemTemplate.createMessage();
  Message userMessage = userTemplate.createMessage(userVariables);

  // 3. ìƒì„±ëœ ë©”ì‹œì§€ë“¤ì„ ë¦¬ìŠ¤íŠ¸ì— ë‹´ì•„ ìµœì¢… Prompt ê°ì²´ë¥¼ ë§Œë“­ë‹ˆë‹¤.
  Prompt prompt = new Prompt(List.of(systemMessage, userMessage));

  // 4. ì™„ì„±ëœ Promptë¥¼ ChatClientì— ì „ë‹¬í•˜ì—¬ AIë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤.
  Flux<String> response = chatClient.prompt(prompt)
      .stream()
      .content();

  return response;
}          
```
---
### 3. ChatClientí´ë˜ìŠ¤ì˜ prompt(), messages() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡¬í”„íŠ¸ ìƒì„± ë°©ë²•
```
  // ChatClient.prompt() ë©”ì†Œë“œ, messages() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ê°ì²´ë¥¼ ì „ë‹¬í•˜ì—¬ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ëŠ” ë°©ë²•ì…ë‹ˆë‹¤ 
  
  public Flux<String> promptTemplate3(String statement, String language) {    
    Flux<String> response = chatClient.prompt()
        .messages(
            systemTemplate.createMessage(),
            userTemplate.createMessage(Map.of("statement", statement, "language", language)))
        .stream()
        .content();
    return response;
  }  

```
---
### 4. ChatClientì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ì„¸ë ¨ëœ ë°©ì‹ (.system()ê³¼ .user() í™œìš©)
```
  public Flux<String> promptTemplate4(String statement, String language) {    
    Flux<String> response = chatClient.prompt()
        .system(systemTemplate.render())
        .user(userTemplate.render(Map.of("statement", statement, "language", language)))
        .stream()
        .content();
    return response;
  }   
```
---
### 5. String.formatted() ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
```
    public Flux<String> promptTemplate5(String statement, String language) {    
        String systemText = """
            ë‹µë³€ì„ ìƒì„±í•  ë•Œ HTMLì™€ CSSë¥¼ ì‚¬ìš©í•´ì„œ íŒŒë€ ê¸€ìë¡œ ì¶œë ¥í•˜ì„¸ìš”.
            <span> íƒœê·¸ ì•ˆì— ë“¤ì–´ê°ˆ ë‚´ìš©ë§Œ ì¶œë ¥í•˜ì„¸ìš”.
            """;
        String userText = """
            ë‹¤ìŒ í•œêµ­ì–´ ë¬¸ì¥ì„ %së¡œ ë²ˆì—­í•´ì£¼ì„¸ìš”.\n ë¬¸ì¥: %s
            """.formatted(language, statement);
        
        Flux<String> response = chatClient.prompt()
            .system(systemText)
            .user(userText)
            .stream()
            .content();
        return response;
    }     

```
---
## 3.2 ë³µìˆ˜ ë©”ì‹œì§€ ì¶”ê°€ 
- LLMì— ìš”ì²­í•  ë•Œ í•˜ë‚˜ì˜ SystemMessageì™€ í•˜ë‚˜ì˜ UserMessageë§Œ í”„ë¡œí”„íŠ¸ì— í¬í•¨ë˜ëŠ” ê²ƒì€ ì•„ë‹˜ 
- í•œê°œì˜ SystemMessageì™€ ì—¬ëŸ¬ ê°œì˜ UserMessage, ì—¬ëŸ¬ ê°œì˜ AssistantMessageë„ ê°™ì´ í¬í•¨ë  ìˆ˜ ìˆìŒ 
- ëŒ€í‘œì ì¸ ì˜ˆë¡œ ëŒ€í™” ê¸°ë¡ì„ ìœ ì§€ í•˜ê¸°, ì´ì „ ëŒ€í™” ë‚´ìš©(UserMessage + AssistantMessage) ì „ì²´ë¥¼ í”„ë¡¬íŠ¸ë“œì— í¬í•¨ ì‹œí‚¬ ìˆ˜ ìˆìŒ 

### serivce/AiServiceMultiMessage.java 
ê¸°ëŠ¥ ì„¤ëª… 

1. ì‹œìŠ¤í…œ ë©”ì‹œì§€(System Message) ìƒì„±
  * SystemMessageëŠ” AI ëª¨ë¸ì—ê²Œ ì—­í• ì„ ë¶€ì—¬í•˜ê±°ë‚˜ í–‰ë™ ì§€ì¹¨ì„ ë‚´ë¦¬ëŠ” íŠ¹ë³„í•œ ë©”ì‹œì§€ì…ë‹ˆë‹¤.
  * ì—¬ê¸°ì„œëŠ” "ë‹¹ì‹ ì€ AI ë¹„ì„œì…ë‹ˆë‹¤. ì§€ë‚œ ëŒ€í™” ë‚´ìš©ì„ ì°¸ê³ í•´ì„œ ë‹µë³€í•´ì£¼ì„¸ìš”." ë¼ëŠ” ì§€ì¹¨ì„ ì„¤ì •í•˜ì—¬, AIê°€ ë‹¨ìˆœíˆ ì§ˆë¬¸ì—ë§Œ ë‹µí•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ ì´ì „ ëŒ€í™”ì˜ ë¬¸ë§¥ì„ íŒŒì•…í•˜ì—¬ ë‹µë³€í•˜ë„ë¡ ìœ ë„í•©ë‹ˆë‹¤.

2. ëŒ€í™” ì´ˆê¸°í™”
  * if(chatMemory.size() == 0): chatMemory ë¦¬ìŠ¤íŠ¸ì˜ í¬ê¸°ê°€ 0ì´ë¼ëŠ” ê²ƒì€ ëŒ€í™”ê°€ ë§‰ ì‹œì‘ë˜ì—ˆìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
  * ì´ë•Œë§Œ SystemMessageë¥¼ chatMemoryì— ì¶”ê°€í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì „ì²´ ëŒ€í™” ì„¸ì…˜ ë™ì•ˆ AIëŠ” ì„¤ì •ëœ ì—­í• ì„ ìœ ì§€í•˜ê²Œ ë©ë‹ˆë‹¤.

3. LLM ìš”ì²­ ë° ì‘ë‹µ (Spring AI `ChatClient` ì‚¬ìš©)
  * chatClient.prompt(): LLMì— ë³´ë‚¼ í”„ë¡¬í”„íŠ¸(ìš”ì²­)ë¥¼ êµ¬ì„±í•˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤.
  * .messages(chatMemory): ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì…ë‹ˆë‹¤. chatMemoryì— ì €ì¥ëœ ì´ì „ ëŒ€í™” ê¸°ë¡ ì „ì²´(SystemMessage í¬í•¨)ë¥¼ ìš”ì²­ì— ì¶”ê°€í•©ë‹ˆë‹¤.
  * .user(question): ê·¸ ë’¤ì— í˜„ì¬ ì‚¬ìš©ìì˜ ì§ˆë¬¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
  * ê²°ê³¼ì ìœ¼ë¡œ [ì‹œìŠ¤í…œ ë©”ì‹œì§€, ì´ì „ ì‚¬ìš©ì ì§ˆë¬¸1, ì´ì „ AI ë‹µë³€1, ì´ì „ ì‚¬ìš©ì ì§ˆë¬¸2, ..., í˜„ì¬ ì‚¬ìš©ì ì§ˆë¬¸] í˜•íƒœì˜ ëŒ€í™” ëª©ë¡ì´ LLMì— ì „ë‹¬ë©ë‹ˆë‹¤.
  * .call().chatResponse(): êµ¬ì„±ëœ í”„ë¡¬í”„íŠ¸ë¥¼ LLMì— ë³´ë‚´ê³ , ì‘ë‹µì´ ì˜¬ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦° í›„(call()), ì „ì²´ ë©”íƒ€ë°ì´í„°ë¥¼ í¬í•¨í•œ ChatResponse ê°ì²´ë¡œ ì‘ë‹µì„ ë°›ìŠµë‹ˆë‹¤.

4. ëŒ€í™” ê¸°ë¡ ì—…ë°ì´íŠ¸ (ìƒíƒœ ê´€ë¦¬)
* LLMìœ¼ë¡œë¶€í„° ë‹µë³€ì„ ë°›ì€ í›„, ë°©ê¸ˆ ì‚¬ìš©ìê°€ ì§ˆë¬¸í•œ ë‚´ìš©(UserMessage)ê³¼ AIê°€ ë‹µë³€í•œ ë‚´ìš©(AssistantMessage)ì„ chatMemory ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•©ë‹ˆë‹¤.
* ì´ë ‡ê²Œ chatMemoryë¥¼ ê³„ì† ì—…ë°ì´íŠ¸í•´ì•¼ ë‹¤ìŒë²ˆ ì§ˆë¬¸ì„ í•  ë•Œ ë°©ê¸ˆ ë‚˜ëˆˆ ëŒ€í™”ê¹Œì§€ í¬í•¨í•˜ì—¬ ë¬¸ë§¥ì„ ìœ ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ chatMemory ê°ì²´ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ê³„ì¸µì—ì„œ ì„¸ì…˜ ë“±ì„ í†µí•´ ê´€ë¦¬ í•´ì•¼ í•©ë‹ˆë‹¤ 

5. ê²°ê³¼ ë°˜í™˜
  * chatResponseì—ì„œ AIì˜ ë‹µë³€ì— í•´ë‹¹í•˜ëŠ” AssistantMessageë¥¼ êº¼ë‚´ê³ , ê·¸ ì•ˆì—ì„œ ì‹¤ì œ í…ìŠ¤íŠ¸ ë‚´ìš©(getText())ì„ ì¶”ì¶œí•˜ì—¬ ë°˜í™˜í•©ë‹ˆë‹¤. ì´ ë¬¸ìì—´ì´ ì‚¬ìš©ìì—ê²Œ ë³´ì—¬ì§ˆ ìµœì¢… ë‹µë³€ì´ ë©ë‹ˆë‹¤.

ìš”ì•½ ë° í•µì‹¬ í¬ì¸íŠ¸

* ìƒíƒœ ìœ ì§€(Stateful) ëŒ€í™”: ì´ ì„œë¹„ìŠ¤ëŠ” chatMemoryë¼ëŠ” Listë¥¼ í†µí•´ ì´ì „ ëŒ€í™” ê¸°ë¡ì„ ê³„ì† ìœ ì§€í•˜ê³  ë‹¤ìŒ ìš”ì²­ì— í™œìš©í•¨ìœ¼ë¡œì¨, ë‹¨ë°œì„± ì§ˆì˜ì‘ë‹µì´ ì•„ë‹Œ ì—°ì†ì ì¸ ëŒ€í™”ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.
* ì—­í•  ê¸°ë°˜ í”„ë¡¬í”„íŒ…: SystemMessageë¥¼ ì´ìš©í•´ AI ëª¨ë¸ì˜ í˜ë¥´ì†Œë‚˜(AI ë¹„ì„œ)ì™€ í–‰ë™ ë°©ì‹ì„ ì§€ì •í•˜ì—¬ ë” ì¼ê´€ë˜ê³  ì›í•˜ëŠ” ë°©í–¥ì˜ ë‹µë³€ì„ ì–»ìŠµë‹ˆë‹¤.
* Spring AI ì¶”ìƒí™”: ë³µì¡í•œ API í˜¸ì¶œ ê³¼ì •ì„ ChatClientë¼ëŠ” ê°ì²´ì™€ .prompt()...call()ê³¼ ê°™ì€ ì§ê´€ì ì¸ ë©”ì†Œë“œ ì²´ì´ë‹ìœ¼ë¡œ ë§¤ìš° ê°„ë‹¨í•˜ê²Œ ì²˜ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê°œë°œìëŠ” HTTP ìš”ì²­/ì‘ë‹µì´ë‚˜ JSON íŒŒì‹±ì— ì‹ ê²½ ì“¸ í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.

**ë™ê¸° ë°©ì‹**ìœ¼ë¡œ êµ¬í˜„í•œ ì´ìœ ëŠ” ë¡œì§ì„ ê°„ë‹¨í•˜ê³  ì‰½ê²Œ ì´í•´ í•  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•´ì„œ ì…ë‹ˆë‹¤.

---
### controller/AiControllerMultiMessage.java
ì´ í´ë˜ìŠ¤ëŠ” ì‚¬ìš©ìì˜ ì›¹ ìš”ì²­ì„ ë°›ì•„ AiServiceMultiMessages ì„œë¹„ìŠ¤ì™€ ì—°ê²°í•´ì£¼ëŠ” ìŠ¤í”„ë§
ì»¨íŠ¸ë¡¤ëŸ¬(Controller) ì…ë‹ˆë‹¤. ì´ ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ê°€ì¥ ì¤‘ìš”í•œ ì—­í• ì€ HTTP ì„¸ì…˜(Session)ì„ ì´ìš©í•´
ì‚¬ìš©ìë³„ ëŒ€í™” ê¸°ë¡ì„ ê´€ë¦¬í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

``` java
@RestController
@RequestMapping("/ai")
@Slf4j
public class AiControllerMultiMessages {
  // ##### í•„ë“œ ##### 
  @Autowired
  private AiServiceMultiMessages aiService;
  
  // ##### ìš”ì²­ ë§¤í•‘ ë©”ì†Œë“œ #####
  @PostMapping(
    value = "/multi-messages",
    consumes = MediaType.APPLICATION_FORM_URLENCODED_VALUE,
    produces = MediaType.TEXT_PLAIN_VALUE
  )
  public String multiMessages(
      @RequestParam("question") String question, HttpSession session) {
    
    // 1. ì„¸ì…˜ì—ì„œ ëŒ€í™” ê¸°ë¡ ê°€ì ¸ì˜¤ê¸°
    List<Message> chatMemory = (List<Message>) session.getAttribute("chatMemory");
    // 2. ëŒ€í™” ê¸°ë¡ì´ ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±
    if(chatMemory == null) {
      chatMemory = new ArrayList<Message>();
      session.setAttribute("chatMemory", chatMemory);
    }
    // 3. ì„œë¹„ìŠ¤ í˜¸ì¶œí•˜ì—¬ ë‹µë³€ ë°›ê¸°
    String answer = aiService.multiMessages(question, chatMemory);
    
    // 4. ë‹µë³€ ë°˜í™˜  }
}

```

---
## 3.3 ë””í´íŠ¸ ë©”ì‹œì§€ì™€ ì˜µì…˜ 

ë””í´íŠ¸ ë©”ì‹œì§€ì™€ ì˜µì…˜ì€ ChatClient ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ë•Œ, í•´ë‹¹ í´ë¼ì´ì–¸íŠ¸ë¥¼ í†µí•´ ë‚˜ê°€ëŠ” ëª¨ë“  ìš”ì²­ì— ì¼ê´€ëœ ê·œì¹™ê³¼ ì„¤ì •ì„ ì ìš©í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. ChatClientë¥¼ ìƒì„±í•  ë•Œ ë””í´íŠ¸ ë©”ì‹œì§€ì™€ ì˜µì…˜ì„ ì„¤ì •í•˜ë©´, LLMì„ ìš”ì²­í•  ë•Œ ìƒëµ(ë©”ì‹œì§€, ì˜µì…˜)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


|ë©”ì†Œë“œ|ì„¤ëª…|
|---|---|
|defaultSystem()| ê¸°ë³¸ SystemMessageë¥¼ ì¶”ê°€ |
|defaultUser()| ê¸°ë³¸ UserMessageë¥¼ ì¶”ê°€ |
|defaultOptions()| ê¸°ë³¸ ëŒ€í™”ì˜µì…˜ì„ ì„¤ì •|

 ì‹œë‚˜ë¦¬ì˜¤: "ê¸ì • ì—ë„ˆì§€ ë¿œë¿œ! ì±—ë´‡" ë§Œë“¤ê¸°

  ìš°ë¦¬ê°€ ë§Œë“¤ê³  ì‹¶ì€ ì±—ë´‡ì˜ ê·œì¹™ì€ ë‹¤ìŒê³¼ ê°™ë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤.

   1. í˜ë¥´ì†Œë‚˜(Persona): ì ì ˆí•œ ê°íƒ„ì‚¬, ì›ƒìŒë“±ì„ ë„£ì–´ì„œ ì¹œì ˆí•˜ê²Œ ëŒ€í™”ë¥¼ í•´ì£¼ì„¸ìš”..
   2. ì–¸ì–´: ëª¨ë“  ë‹µë³€ì€ ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ í•´ì•¼ í•œë‹¤.
   3. ì°½ì˜ì„±: ì•½ê°„ ì°½ì˜ì ì´ê³  ë‹¤ì–‘í•œ ë‹µë³€ì„ ìƒì„±í•´ì•¼ í•œë‹¤. (ë„ˆë¬´ ë”±ë”±í•˜ì§€ ì•Šê²Œ)
   4. í† í° : ë„ˆë¬´ ê¸´ ë‹µë³€ì„ í•˜ì§€ ì•Šë„ë¡ ìµœëŒ€í† í° ìˆ˜ë¥¼ 300ìœ¼ë¡œ ì„¤ì •í•œë‹¤
   5. ëª¨ë¸: ë¹„ìš© ì ˆì•½ì„ ìœ„í•´ gpt-3.5-turbo ëª¨ë¸ì„ ì‚¬ìš©í•œë‹¤.

  ì´ ê·œì¹™ë“¤ì„ ëª¨ë“  AI ìš”ì²­ë§ˆë‹¤ ë°˜ë³µí•´ì„œ ì„¤ì •í•˜ëŠ” ê²ƒì€ ë²ˆê±°ë¡­ê³  ì‹¤ìˆ˜ì˜ ì—¬ì§€ê°€ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ ë””í´íŠ¸ ë©”ì‹œì§€ì™€ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ì´ ê·œì¹™ë“¤ì„ ë‹¨ í•œ ë²ˆë§Œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

service/AiServiceDefaultMethod.java 

```java

@Service
@Slf4j
public class AiServiceDefaultMethod {
  // ##### í•„ë“œ #####
  private ChatClient chatClient;

  // ##### ìƒì„±ì #####
  public AiServiceDefaultMethod(ChatClient.Builder chatClientBuilder) {
    chatClient = chatClientBuilder
        .defaultSystem("""
          ì ì ˆí•œ ê°íƒ„ì‚¬, ì›ƒìŒë“±ì„ ë„£ì–´ì„œ ì¹œì ˆí•˜ê²Œ ëŒ€í™”ë¥¼ í•´ì£¼ì„¸ìš”.
          ëª¨ë“  ë‹µë³€ì€ ë°˜ë“œì‹œ í•œêµ­ì–´ë¡œ í•´ì•¼ í•©ë‹ˆë‹¤.
          """)
        .defaultOptions(ChatOptions.builder()
            .temperature(1.0)
            .maxTokens(300)
            .model("gpt-3.5-turbo")
            .build())
        .build();
  }

  // ##### ë©”ì†Œë“œ #####
  public Flux<String> defaultMethod(String question) {   
    Flux<String> response = chatClient.prompt()
        .user(question)
        .stream()
        .content();
    return response;
  }
}
```

controller/AiControllerDefaultMethod.java 
```java

@RestController
@RequestMapping("/ai")
@Slf4j
public class AiControllerDefaultMethod {
  // ##### í•„ë“œ ##### 
  @Autowired
  private AiServiceDefaultMethod aiService;
  
  // ##### ë©”ì†Œë“œ #####
  @PostMapping(
    value = "/default-method",
    consumes = MediaType.APPLICATION_FORM_URLENCODED_VALUE,
    produces = MediaType.APPLICATION_NDJSON_VALUE
  )
  public Flux<String> defaultMethod(@RequestParam("question") String question) {
    return aiService.defaultMethod(question);
  }
}

```

ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ í•˜ì—¬ í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°
http://localhost:8080/default-methodì„ ì‹¤í–‰í•˜ê³  ì œì¶œì„ í•˜ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì¶œë ¥ë©ë‹ˆë‹¤ 

![alt text](image-3.png)
---

## 3.4 í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ì´ë€?

í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ì€ AI ëª¨ë¸(íŠ¹íˆ LLM)ë¡œë¶€í„° ì›í•˜ëŠ” ìµœìƒì˜ ê²°ê³¼ë¥¼ ì–»ì–´ë‚´ê¸° ìœ„í•´, ëª¨ë¸ì— ì…ë ¥í•˜ëŠ” ì§ˆë¬¸ì´ë‚˜ ì§€ì‹œì–´(í”„ë¡¬í”„íŠ¸)ë¥¼ ìµœì í™”í•˜ëŠ” ê¸°ìˆ ì´ì ê³¼ì •ì…ë‹ˆë‹¤. ë‹¨ìˆœíˆ ì§ˆë¬¸ì„ ë˜ì§€ëŠ” ê²ƒì„ ë„˜ì–´, AIê°€ ë” ì •í™•í•˜ê³ , ì°½ì˜ì ì´ë©°, ì¼ê´€ëœ ë‹µë³€ì„ ìƒì„±í•˜ë„ë¡ ìœ ë„í•˜ëŠ” 'AIì™€ì˜ ì†Œí†µë²•'ì´ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ê¸°ë³¸ ê¸°ë²•

| ê¸°ë²• (Technique) | ì„¤ëª…| í•µì‹¬ ëª©í‘œ| ì˜ˆì‹œ (Bad Prompt â†’ Good Prompt)|
|:---|:---|:---|:---|
|1. ëª…í™•í•˜ê³  êµ¬ì²´ì ìœ¼ë¡œ ì§€ì‹œí•˜ê¸° | ëª¨í˜¸í•œ í‘œí˜„ì„ í”¼í•˜ê³ , ì›í•˜ëŠ” ê²°ê³¼ë¬¼ì— ëŒ€í•œ ìƒì„¸í•œ ë§¥ë½, ì¡°ê±´, ìš”êµ¬ì‚¬í•­ì„ ëª…ì‹œì ìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤. | AIì˜ ì¶”ì¸¡ì„ ìµœì†Œí™”í•˜ê³ , ì˜ë„ì— ê°€ì¥ ê°€ê¹Œìš´ ì •í™•í•œ ë‹µë³€ì„ ìœ ë„í•©ë‹ˆë‹¤.| Bad: "ìŠ¤í”„ë§ì— ëŒ€í•´ ì•Œë ¤ì¤˜."<br>Good: "Java ì›¹ ê°œë°œ ì´ˆë³´ìë¥¼ ìœ„í•´, ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì˜ í•µì‹¬ íŠ¹ì§• 3ê°€ì§€ë¥¼ ì„¤ëª…í•˜ê³ , ê° íŠ¹ì§•ì´ ì™œ ì¤‘ìš”í•œì§€ ê°„ë‹¨í•œ ì˜ˆì‹œì™€ í•¨ê»˜ ì•Œë ¤ì¤˜.|
|2. ì—­í•  ì§€ì •í•˜ê¸° (Persona Pattern) | AIì—ê²Œ íŠ¹ì • ì „ë¬¸ê°€, ì¸ë¬¼, ìºë¦­í„° ë“±ì˜ ì—­í• ì„ ë¶€ì—¬í•˜ì—¬ ê·¸ ì—­í• ì— ë§ëŠ” í†¤ê³¼ ìŠ¤íƒ€ì¼, ì§€ì‹ ìˆ˜ì¤€ìœ¼ë¡œ ë‹µë³€í•˜ê²Œ í•©ë‹ˆë‹¤. | ë‹µë³€ì˜ ìŠ¤íƒ€ì¼, ì–´ì¡°, ì „ë¬¸ì„± ìˆ˜ì¤€ì„ ì œì–´í•˜ì—¬ íŠ¹ì • ëª©ì ì— ë§ëŠ” ê²°ê³¼ë¬¼ì„ ì–»ìŠµë‹ˆë‹¤. | Bad: "ì´ ì½”ë“œë¥¼ ë¦¬ë·°í•´ì¤˜."<br>Good: "ë‹¹ì‹ ì€ 10ë…„ì°¨ ì‹œë‹ˆì–´ ë°±ì—”ë“œ ê°œë°œìì…ë‹ˆë‹¤. ì•„ë˜ Java ì½”ë“œì˜ ì„±ëŠ¥, ê°€ë…ì„±, ì ì¬ì  ë²„ê·¸ ê´€ì ì—ì„œ ë¦¬ë·°í•˜ê³  ê°œì„ ì ì„ ì œì•ˆí•´ì£¼ì„¸ìš”."|
|3. ì˜ˆì‹œ ì œê³µí•˜ê¸° (Few-Shot Prompting)|AIê°€ ë”°ë¼ì•¼ í•  ì…/ì¶œë ¥ì˜ ì˜ˆì‹œ(1ê°œ~ì—¬ëŸ¬ ê°œ)ë¥¼ í”„ë¡¬í”„íŠ¸ì— í¬í•¨ì‹œì¼œ, ì›í•˜ëŠ” ê²°ê³¼ë¬¼ì˜ í˜•ì‹ê³¼ íŒ¨í„´ì„ í•™ìŠµì‹œí‚µë‹ˆë‹¤.| ë³µì¡í•˜ê±°ë‚˜ ìƒˆë¡œìš´ í˜•ì‹ì˜ ì‘ì—…ì„ AIì—ê²Œ ê°€ë¥´ì¹˜ê³ , ê²°ê³¼ë¬¼ì˜ ì¼ê´€ì„±ì„ ë†’ì…ë‹ˆë‹¤. | Bad: "ì´ ë¬¸ì¥ì´ ê¸ì •ì¸ì§€ ë¶€ì •ì¸ì§€ íŒë‹¨í•´ì¤˜: 'ìŒì‹ì´ ë„ˆë¬´ ë§›ì—†ì–´ìš”.'"<br>Good: "ë‹¤ìŒ ì˜ˆì‹œì²˜ëŸ¼ ë¬¸ì¥ì˜ ê°ì„±ì„ ë¶„ì„í•´ì¤˜.<br>ì˜ˆì‹œ1) ë¬¸ì¥: "ì´ ì˜í™” ì •ë§ ìµœê³ ì•¼!" -> ê°ì„±: ê¸ì •<br>ì˜ˆì‹œ2) ë¬¸ì¥: "ê¸°ë‹¤ë¦¬ë‹¤ ì§€ì³¤ì–´ìš”." -> ê°ì„±: ë¶€ì •<br><br>ì´ì œ ì´ê±¸ ë¶„ì„í•´ì¤˜.<br>ë¬¸ì¥: "ìŒì‹ì´ ë„ˆë¬´ ë§›ì—†ì–´ìš”." -> ê°ì„±:"|
|4. ì¶œë ¥ í˜•ì‹ ì§€ì •í•˜ê¸° (Specify Output Format) | AIê°€ ë‹µë³€ì´ ì–´ë–¤ í˜•ì‹(JSON, Markdown, XML, ë¦¬ìŠ¤íŠ¸ ë“±)ìœ¼ë¡œ ìƒì„±ë˜ì–´ì•¼ í•˜ëŠ”ì§€ ëª…í™•í•˜ê²Œ ì§€ì •í•©ë‹ˆë‹¤. | í”„ë¡œê·¸ë¨ì´ í›„ì²˜ë¦¬í•˜ê¸° ì‰¬ìš´ êµ¬ì¡°í™”ëœ ë°ì´í„°ë¥¼ ì–»ê±°ë‚˜, ê°€ë…ì„± ë†’ì€ ê²°ê³¼ë¬¼ì„ í™•ë³´í•©ë‹ˆë‹¤. | Bad: "ë°”ë‚˜ë‚˜, ì‚¬ê³¼, ì˜¤ë Œì§€ì˜ ì¥ë‹¨ì ì„ ì•Œë ¤ì¤˜."<br>Good: "ë°”ë‚˜ë‚˜, ì‚¬ê³¼, ì˜¤ë Œì§€ì˜ ì¥ë‹¨ì ì„ ì•„ë˜ì™€ ê°™ì€ ë§ˆí¬ë‹¤ìš´ í…Œì´ë¸” í˜•ì‹ìœ¼ë¡œ ì •ë¦¬í•´ì¤˜.|
|5. ë‹¨ê³„ë³„ë¡œ ìƒê°í•˜ê²Œ ìœ ë„í•˜ê¸° (Chain of Thought)|ë³µì¡í•œ ë¬¸ì œì— ëŒ€í•´ AIê°€ ìµœì¢… ë‹µë³€ì„ ë‚´ë¦¬ê¸° ì „ì—, ë¬¸ì œ í•´ê²° ê³¼ì •ì´ë‚˜ ë…¼ë¦¬ì  ë‹¨ê³„ë¥¼ ìŠ¤ìŠ¤ë¡œ ìƒê°í•˜ê³  ì„œìˆ í•˜ë„ë¡ ìœ ë„í•©ë‹ˆë‹¤.|ìˆ˜í•™, ë…¼ë¦¬ ì¶”ë¡  ë“± ë³µì¡í•œ ë¬¸ì œì˜ ì •í™•ë„ë¥¼ í¬ê²Œ í–¥ìƒì‹œí‚¤ê³ , ë‹µë³€ì˜ ê·¼ê±°ë¥¼ íˆ¬ëª…í•˜ê²Œ í™•ì¸í•©ë‹ˆë‹¤.|Bad: "ì‚¬ê³¼ 5ê°œë¥¼ 3ëª…ì´ ë‚˜ëˆ  ê°€ì§€ë©´ í•œ ëª…ë‹¹ ëª‡ ê°œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‚˜?"<br>Good: "ì‚¬ê³¼ 5ê°œë¥¼ 3ëª…ì´ ë‚˜ëˆ  ê°€ì§€ë©´ í•œ ëª…ë‹¹ ëª‡ ê°œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆëŠ”ì§€ ê³„ì‚°í•´ì¤˜. ë‹¨ê³„ë³„ë¡œ ìƒê°í•´ì„œ ì„¤ëª…í•´ì¤˜."|
|6. êµ¬ë¶„ì ì‚¬ìš©í•˜ê¸° (Use Delimiters) |ì§€ì‹œë¬¸, ë§¥ë½(context), ì…ë ¥ ë°ì´í„° ë“± í”„ë¡¬í”„íŠ¸ì˜ ê° ë¶€ë¶„ì„ ëª…í™•í•˜ê²Œ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ êµ¬ë¶„ì(ì˜ˆ: """, ###, <tag>)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.|AIê°€ ì§€ì‹œë¬¸ê³¼ ì²˜ë¦¬í•´ì•¼ í•  ë°ì´í„°ë¥¼ í˜¼ë™í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê³ , í”„ë¡¬í”„íŠ¸ì˜ êµ¬ì¡°ë¥¼ ëª…í™•í•˜ê²Œ í•©ë‹ˆë‹¤. |Bad: "ì•„ë˜ ê¸€ì„ ìš”ì•½í•´ì¤˜. ì¸ê³µì§€ëŠ¥ì€..."<br>Good: "ë‹¹ì‹ ì´ ìš”ì•½í•´ì•¼ í•  í…ìŠ¤íŠ¸ëŠ” ì„¸ ê°œì˜ ë”°ì˜´í‘œ(""")ë¡œ ë‘˜ëŸ¬ì‹¸ì—¬ ìˆìŠµë‹ˆë‹¤.<br><br>"""<br>ì¸ê³µì§€ëŠ¥ì€ ì¸ê°„ì˜ í•™ìŠµëŠ¥ë ¥, ì¶”ë¡ ëŠ¥ë ¥, ì§€ê°ëŠ¥ë ¥ ë“±ì„ ì¸ê³µì ìœ¼ë¡œ êµ¬í˜„í•œ ì»´í“¨í„° ì‹œìŠ¤í…œì´ë‹¤...<br>"""<br><br>ìœ„ í…ìŠ¤íŠ¸ë¥¼ í•œ ë¬¸ì¥ìœ¼ë¡œ ìš”ì•½í•´ì¤˜."|
|7. ë¶€ì •ì  í‘œí˜„ë³´ë‹¤ ê¸ì •ì  ì§€ì‹œ ì‚¬ìš©í•˜ê¸°|"~í•˜ì§€ ë§ˆë¼"ëŠ” ë¶€ì •ì ì¸ ì§€ì‹œë³´ë‹¤ëŠ” "~í•´ë¼"ëŠ” ê¸ì •ì ì´ê³  ì§ì ‘ì ì¸ ì§€ì‹œë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. | AIê°€ ë¶€ì •ì ì¸ ì§€ì‹œë¥¼ ë†“ì¹˜ê±°ë‚˜ ì˜ëª» í•´ì„í•  ê°€ëŠ¥ì„±ì„ ì¤„ì´ê³ , ì›í•˜ëŠ” í–‰ë™ì„ ë” í™•ì‹¤í•˜ê²Œ ìœ ë„í•©ë‹ˆë‹¤.| Bad: "ì „ë¬¸ ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ê³  ì„¤ëª…í•´ì¤˜."<br>Good: "ì´ˆë“±í•™ìƒë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì‰¬ìš´ ë‹¨ì–´ë¥¼ ì‚¬ìš©í•´ì„œ ì„¤ëª…í•´ì¤˜." |


ì´ëŸ¬í•œ ê¸°ë²•ë“¤ì€ ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš©ë  ìˆ˜ë„ ìˆê³ , ì—¬ëŸ¬ ê¸°ë²•ì„ ì¡°í•©í•˜ì—¬ ë” ì •êµí•˜ê³  íš¨ê³¼ì ì¸ í”„ë¡¬í”„íŠ¸ë¥¼ êµ¬ì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì¢‹ì€ í”„ë¡¬í”„íŠ¸ë¥¼ ë§Œë“œëŠ” ê²ƒì€ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ê¸° ìœ„í•œ ë°˜ë³µì ì¸ ì‹¤í—˜ê³¼ ê°œì„ ì˜ ê³¼ì •ì…ë‹ˆë‹¤.


í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ 6ëŒ€ í•µì‹¬ ê¸°ë²•

  1. ì œë¡œìƒ· í”„ë¡¬í”„íŒ… (Zero-Shot Prompting)
  2. ì—°ì‡„ì  ì‚¬ê³  í”„ë¡¬í”„íŒ… (Chain of Thought - CoT)
  3. ì—­í•  ë¶€ì—¬ í”„ë¡¬í”„íŒ… (Role-Playing Prompting)
  4. ìŠ¤íƒ­-ë°± í”„ë¡¬í”„íŠ¸(Step-back Prompting)
  5. ìƒê°ì˜ ì‚¬ìŠ¬ í”„ë¡¬í”„íŒ… (Chain of Thought - CoT)
  6. ìê¸° ì¼ê´€ì„± ê¸°ë²• (Self-Consistency)

---
## 3.5 ì œë¡œ-ìƒ· í”„ë¡¬í”„íŒ…

### ë˜‘ë˜‘í•œ ì¹œêµ¬ì—ê²Œ ì²˜ìŒ ë¬¼ì–´ë³´ê¸°

ì˜ˆë¥¼ ë“¤ì–´ ì—¬ê¸°ì— ì—„ì²­ë‚˜ê²Œ ë˜‘ë˜‘í•œ ì¹œêµ¬ 'ì²™ì²™ë°•ì‚¬ AI'ê°€ ìˆë‹¤ê³  ìƒìƒí•´ ë´ìš”. ì´ ì¹œêµ¬ëŠ” ì„¸ìƒì˜ ëª¨ë“  ì±…ì„ ë‹¤ ì½ì–´ì„œ ëª¨ë¥´ëŠ” ê²Œ ê±°ì˜ ì—†ì–´ìš”.

ì–´ëŠ ë‚ , ì—¬ëŸ¬ë¶„ì´ ì´ ì¹œêµ¬ì—ê²Œ ë‹¤ê°€ê°€ì„œ ì•„ë¬´ëŸ° íŒíŠ¸ë‚˜ ì˜ˆì‹œ ì—†ì´ ê·¸ëƒ¥ ë°”ë¡œ ì§ˆë¬¸ì„ ë˜ì§€ëŠ” ê±°ì˜ˆìš”.
```
ì§ˆë¬¸> "ì•ˆë…•! 'ê°•ì•„ì§€'ë¥¼ ì˜ì–´ë¡œ ë­ë¼ê³  í•´?"

ì²™ì²™ë°•ì‚¬ AIëŠ” ì ì‹œ ìƒê°í•˜ë”ë‹ˆ ë°”ë¡œ "Dog!"ë¼ê³  ëŒ€ë‹µí•´ ì¤˜ìš”.
```
ë°”ë¡œ ì´ê²Œ ì œë¡œìƒ· í”„ë¡¬í”„íŠ¸ì˜ˆìš”!

* ì œë¡œ(Zero): '0ê°œ'ë¼ëŠ” ëœ»ì´ì—ìš”.
* ìƒ·(Shot): 'ê¸°íšŒ' ë˜ëŠ” 'ì‹œë„'ë¼ëŠ” ëœ»ì¸ë°, ì—¬ê¸°ì„œëŠ” 'íŒíŠ¸'ë¼ê³  ìƒê°í•˜ë©´ ì‰¬ì›Œìš”.

ì¦‰, 'íŒíŠ¸ë¥¼ 0ê°œ ì£¼ê³  ë°”ë¡œ ë¬¼ì–´ë³´ëŠ” ê²ƒ'ì„ ì œë¡œìƒ· í”„ë¡¬í”„íŠ¸ë¼ê³  ë¶ˆëŸ¬ìš”.

ì—¬ëŸ¬ë¶„ì€ ì²™ì²™ë°•ì‚¬ AIì—ê²Œ "ê³ ì–‘ì´ëŠ” Catì´ì•¼" ë¼ê±°ë‚˜ "ì‚¬ìëŠ” Lionì´ì•¼" ê°™ì€ ì—°ìŠµ ë¬¸ì œ(ì˜ˆì‹œ)ë¥¼ í•˜ë‚˜ë„ ë³´ì—¬ì£¼ì§€ ì•Šì•˜ì–´ìš”. ê·¸ëƒ¥ AIê°€ ì›ë˜ë¶€í„° ë˜‘ë˜‘í•˜ë‹¤ëŠ” ê±¸ ë¯¿ê³ , ê³§ë°”ë¡œ ì§ˆë¬¸ì„ ë˜ì§„ ê±°ì£ .

AIê°€ ì´ë¯¸ ìˆ˜ë§ì€ ì •ë³´ë¥¼ ê³µë¶€í•´ì„œ 'ê°•ì•„ì§€'ê°€ ì˜ì–´ë¡œ 'Dog'ë¼ëŠ” ê±¸ ì•Œê³  ìˆê¸° ë•Œë¬¸ì— ì •ë‹µì„ ë§í ìˆ˜ ìˆì—ˆë˜ ê±°ì˜ˆìš”.

ì •ë¦¬í•˜ë©´, ì œë¡œìƒ· í”„ë¡¬í”„íŠ¸ëŠ” AIì—ê²Œ ì–´ë–¤ ì¼ì„ ì‹œí‚¬ ë•Œ, ì°¸ê³ í•  ë§Œí•œ ì˜ˆì‹œë¥¼ ì „í˜€ ì£¼ì§€ ì•Šê³  "ë„¤ ì‹¤ë ¥ì„ ë¯¿ì„ê²Œ! ë°”ë¡œ í•œë²ˆ í•´ë´!" í•˜ê³  ë°”ë¡œ ë¬¼ì–´ë³´ëŠ” ë°©ì‹ì„ ë§í•œë‹µë‹ˆë‹¤.

### ì™œ ì´ê²ƒì´ ì œë¡œìƒ·(Zero-Shot)ì¸ê°€ìš”?

ì œë¡œìƒ· í”„ë¡¬í”„íŠ¸ë¥¼ ì´ìš©í•´ì„œ ë¦¬ë·° ê°ì •ì„ 'ê¸ì •ì ', 'ì¤‘ë¦½ì ', 'ë¶€ì •ì 'ìœ¼ë¡œ ë¶„ë¥˜í•˜ëŠ” ì˜ˆì œë¥¼ ì‘ì„± í•´ë³´ê² ìŠµë‹ˆë‹¤

í•µì‹¬ì€ AIì—ê²Œ ë¶„ë¥˜ ì˜ˆì‹œë¥¼ ë‹¨ í•˜ë‚˜ë„ ë³´ì—¬ì£¼ì§€ ì•Šê³ , ì˜¤ì§ ëª…í™•í•œ ì§€ì‹œë¬¸ê³¼ ë¶„ì„í•  í…ìŠ¤íŠ¸ë§Œìœ¼ë¡œ ì‘ì—…ì„ ìš”ì²­í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ì œë¡œìƒ· ê°ì • ë¶„ë¥˜ í”„ë¡¬í”„íŠ¸ ì˜ˆì œ

ì•„ë˜ í”„ë¡¬í”„íŠ¸ëŠ” AIì—ê²Œ í•´ì•¼ í•  ì‘ì—…, ë¶„ë¥˜í•  ì¹´í…Œê³ ë¦¬, ê·¸ë¦¬ê³  ë¶„ì„í•  ë¦¬ë·° í…ìŠ¤íŠ¸ë¥¼ ëª…í™•í•˜ê²Œ ì „ë‹¬í•©ë‹ˆë‹¤.

ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ êµ¬ì¡°
```
[ì§€ì‹œë¬¸]
ì˜í™” ë¦¬ë·°ë¥¼ [ê¸ì •ì , ì¤‘ë¦½ì , ë¶€ì •ì ] ì¤‘ì—ì„œ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”. ë ˆì´ë¸”ë§Œ ë°˜í™˜í•˜ì„¸ìš”.

[ë¦¬ë·°]
{ewview}

[ê°ì • ë¶„ë¥˜]
```

ì˜ˆì‹œ 1: ê¸ì •ì ì¸ ë¦¬ë·° ë¶„ë¥˜
```
[ì§€ì‹œë¬¸]
ì˜í™” ë¦¬ë·°ë¥¼ [ê¸ì •ì , ì¤‘ë¦½ì , ë¶€ì •ì ] ì¤‘ì—ì„œ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”. ë ˆì´ë¸”ë§Œ ë°˜í™˜í•˜ì„¸ìš”.

[ë¦¬ë·°]
ìš°ì™€!! ^^ ì„¸ê³„ ìµœê³ ì˜ ëŒ€ë°°ìš°ì´ì‹  ì¡´ê²½í•˜ëŠ” ìš°ë¦¬ íƒí¬ë£¨ì¦ˆë‹˜ì˜ ì•¡ì…˜ì—°ê¸°ê°€ ì •ë§ í™˜ìƒì ì´ë„¤ìš”!!! ^^ ì¡´ê²½í•˜ëŠ” ìš°ë¦¬ í†° í¬ë£¨ì¦ˆë‹˜, í—¤ì¼ë¦¬ ì•³ì›°ë‹˜, ë¹™ ë¼ë©”ìŠ¤ë‹˜, ì‚¬ì´ë¨¼ í˜ê·¸ë‹˜, ì—ì‚¬ì´ ëª¨ë„ë ˆìŠ¤ë‹˜, í¼ í´ë ˆë©˜í‹°ì—í”„ë‹˜, ê·¸ë ‰ íƒ€ì” ë°ì´ë¹„ìŠ¤ë‹˜ ë“±ì˜ ì—´ì—°ì´ ê°€ìŠ´ ë­‰í´í•œ ì•¡ì…˜ëŒ€ì‘ì…ë‹ˆë‹¤~~^^ğŸ˜ŠğŸ¤©ğŸ˜€ğŸ˜ì¡´ê²½í•˜ëŠ” ìš°ë¦¬ 'ë¯¸ì…˜ ì„íŒŒì„œë¸”: íŒŒì´ë„ ë ˆì½”ë‹' ì˜í™” ê´€ëŒì„ ê°•ì¶”~ ê°•ì¶”ë“œë¦½ë‹ˆë‹¤~^^ 'ë¯¸ì…˜ ì„íŒŒì„œë¸”: íŒŒì´ë„ ë ˆì½”ë‹' íŒ€ì˜ ë‚´í•œì— ê¹Šì´ ê³ ê°œ ìˆ™ì—¬ ê°ì‚¬ ì¸ì‚¬ë“œë¦¬ë©°, ì˜í™”ì˜ ëŒ€ë°•ì„ ê¸°ì›ë“œë¦½ë‹ˆë‹¤!! ^^ğŸ˜ŠğŸ¤©ğŸ˜¬ğŸ’â™¥â™¥â™¥â™¥â™¥

[ê°ì • ë¶„ë¥˜]
ì˜ˆìƒë˜ëŠ” AIì˜ ë‹µë³€: ê¸ì •ì 
```

ì˜ˆì‹œ 2: ë¶€ì •ì ì¸ ë¦¬ë·° ë¶„ë¥˜
```
[ì§€ì‹œë¬¸]
ì˜í™” ë¦¬ë·°ë¥¼ [ê¸ì •ì , ì¤‘ë¦½ì , ë¶€ì •ì ] ì¤‘ì—ì„œ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”. ë ˆì´ë¸”ë§Œ ë°˜í™˜í•˜ì„¸ìš”.

[ë¦¬ë·°]
ì—­ëŒ€ ë¯¸ì…˜ ì„íŒŒì„œë¸” ë³´ë‹¤ ìµœê³ ë¡œ ë…¸ì¼.ê³„ì† ë´ì™”ë˜ ë¹„ìŠ·í•œ ì•¡ì…˜ì´ë¼ ì‹ ì„ í•¨ì´ ë–¨ì–´ì§€ê³  ì¡´ì¬ê°ì„ ì•Œ ìˆ˜ ì—†ëŠ” íŒ€ì›ê³¼ ëª‡ëª‡ ë“±ì¥ ì¸ë¬¼. ëŠ˜ì–´ì§€ëŠ” í¸ì§‘ìœ¼ë¡œ ì§€ë£¨í•¨ì„ ëŠë‚Œ.

[ê°ì • ë¶„ë¥˜]
ì˜ˆìƒë˜ëŠ” AIì˜ ë‹µë³€: ë¶€ì •ì 
```

ì˜ˆì‹œ 3: ì¤‘ë¦½ì ì¸ ë¦¬ë·° ë¶„ë¥˜
```
[ì§€ì‹œë¬¸]
ì˜í™” ë¦¬ë·°ë¥¼ [ê¸ì •ì , ì¤‘ë¦½ì , ë¶€ì •ì ] ì¤‘ì—ì„œ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”. ë ˆì´ë¸”ë§Œ ë°˜í™˜í•˜ì„¸ìš”.

[ë¦¬ë·°]
ì´ë²ˆ ë¯¸ì…˜ ì„íŒŒì„œë¸” 8ì€ ì‹œë¦¬ì¦ˆì˜ ë§ˆë¬´ë¦¬ë‹µê²Œ ìŠ¤ì¼€ì¼ì´ í¬ê³  ì™„ì„±ë„ ë†’ì€ ì•¡ì…˜ì„ ì„ ë³´ì¸ë‹¤. ì—¬ì „íˆ í†° í¬ë£¨ì¦ˆì˜ ì—´ì •ì ì¸ ì—°ê¸°ì™€ ì‹¤ì œë¡œ ìˆ˜í–‰í•œ ìŠ¤í„´íŠ¸ ì¥ë©´ë“¤ì€ ì¸ìƒì ì´ì§€ë§Œ, ì´ì „ ì‘í’ˆë“¤ê³¼ ë¹„êµí–ˆì„ ë•Œ í° ìƒˆë¡œì›€ì€ ëŠê»´ì§€ì§€ ì•ŠëŠ”ë‹¤. ìŠ¤í† ë¦¬ëŠ” ë³µì¡í•œ ìŒëª¨ì™€ ì²©ë³´ì „ì˜ ê¸´ì¥ê°ì„ ìœ ì§€í•˜ë ¤ í–ˆì§€ë§Œ ë‹¤ì†Œ ëŠ˜ì–´ì§€ëŠ” ë¶€ë¶„ë„ ìˆë‹¤. íŒ¬ë“¤ì—ê²ŒëŠ” ìµìˆ™í•œ ì¬ë¯¸ë¥¼ ì£¼ì§€ë§Œ, ìƒˆë¡œìš´ ê´€ê°ì—ê²ŒëŠ” ì•½ê°„ ë¶€ë‹´ìŠ¤ëŸ¬ìš¸ ìˆ˜ë„ ìˆëŠ” ì‘í’ˆì´ë‹¤. ì „ì²´ì ìœ¼ë¡œ ë¬´ë‚œí•˜ê²Œ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ì•¡ì…˜ ì˜í™”ì˜€ë‹¤.

[ê°ì • ë¶„ë¥˜]
ì˜ˆìƒë˜ëŠ” AIì˜ ë‹µë³€: ì¤‘ë¦½ì 
```
---

ìœ„ ì˜ˆì‹œë“¤ ì–´ë””ì—ë„ "ì´ëŸ° ë¬¸ì¥ì€ ê¸ì •ì´ì•¼" ë˜ëŠ” "ì €ëŸ° ë¬¸ì¥ì€ ë¶€ì •ì´ì•¼" ì™€ ê°™ì€ í•™ìŠµìš© ì˜ˆì œê°€ ì „í˜€ í¬í•¨ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.

ì˜¤ì§ "ê°ì •ì„ ì´ ì„¸ ê°€ì§€ ì¹´í…Œê³ ë¦¬ë¡œ ë¶„ë¥˜í•´ì¤˜"ë¼ëŠ” ì§€ì‹œì™€ "ì´ê²Œ ë¶„ì„í•  ë¬¸ì¥ì´ì•¼"ë¼ëŠ” ê³¼ì œë§Œ ì£¼ì–´ì¡ŒìŠµë‹ˆë‹¤. AIëŠ” ìì‹ ì´ ë¯¸ë¦¬ í•™ìŠµí•œ ë°©ëŒ€í•œ ì–¸ì–´ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ 'ë§Œì¡±', 'ì¶”ì²œ' ê°™ì€ ë‹¨ì–´ê°€ ê¸ì •ì ì¸ ëŠë‚Œì„ ì¤€ë‹¤ëŠ” ê²ƒì„ ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•˜ì—¬ ê²°ê³¼ë¥¼ ë‚´ë†“ìŠµë‹ˆë‹¤. ì´ê²ƒì´ ë°”ë¡œ ì œë¡œìƒ· í”„ë¡¬í”„íŠ¸ì˜ í•µì‹¬ì…ë‹ˆë‹¤.

---
### service/AiServiceZeroShotPrompt.java 

``` java

@Service
@Slf4j
public class AiServiceZeroShotPrompt {
  // ##### í•„ë“œ #####
  private ChatClient chatClient;
  private PromptTemplate promptTemplate = PromptTemplate.builder()
      .template("""
          ì˜í™” ë¦¬ë·°ë¥¼ [ê¸ì •ì , ì¤‘ë¦½ì , ë¶€ì •ì ] ì¤‘ì—ì„œ í•˜ë‚˜ë¡œ ë¶„ë¥˜í•˜ì„¸ìš”.
          ë ˆì´ë¸”ë§Œ ë°˜í™˜í•˜ì„¸ìš”.
          ë¦¬ë·°: {review}
        """)
      .build();

  // ##### ìƒì„±ì #####
  public AiServiceZeroShotPrompt(ChatClient.Builder chatClientBuilder) {
    chatClient = chatClientBuilder
        .defaultOptions(ChatOptions.builder()
            .temperature(0.0)
            .maxTokens(4)
            .build())
        .build();
  }

  // ##### ë©”ì†Œë“œ #####
  public String zeroShotPrompt(String review) {
    String sentiment = chatClient.prompt()
        .user(promptTemplate.render(Map.of("review", review)))
        .call()
        .content();
    return sentiment;
  }
}

```

### controller/AiControllerZeroShotPrompt.java

``` java
@RestController
@RequestMapping("/ai")
@Slf4j
public class AiControllerZeroShotPrompt {
  // ##### í•„ë“œ ##### 
  @Autowired
  private AiServiceZeroShotPrompt aiService;
  
  //##### ë©”ì†Œë“œ ##### 
  @PostMapping(
    value = "/zero-shot-prompt",
    consumes = MediaType.APPLICATION_FORM_URLENCODED_VALUE,
    produces = MediaType.TEXT_PLAIN_VALUE
  )
  public String zeroShotPrompt(@RequestParam("review") String review) {
    String reviewSentiment = aiService.zeroShotPrompt(review);
    return reviewSentiment;
  }  
}

```


ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ í•˜ì—¬ í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°
http://localhost:8080/zero-shot-prompt ì„ ì‹¤í–‰í•˜ê³  ì œì¶œì„ í•˜ë©´ ìƒí™©ì— ë§ëŠ” ë¦¬ë·° ë¥¼ ì…ë ¥í•˜ê³  ì œì¶œì„ í´ë¦­í•˜ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì¶œë ¥ë©ë‹ˆë‹¤ 

![alt text](image-4.png)

----

## 3.6 í“¨-ìƒ· í”„ë¡¬í”„íŠ¸ 
í“¨ìƒ· í”„ë¡¬í”„íŠ¸(Few-Shot Prompt)ì´ë€?

### ë˜‘ë˜‘í•œ ì¹œêµ¬ì—ê²Œ íŒíŠ¸ ì£¼ê¸°

ì§€ë‚œë²ˆì— ë§Œë‚¬ë˜ ë˜‘ë˜‘í•œ ì¹œêµ¬ 'ì²™ì²™ë°•ì‚¬ AI'ë¥¼ ë‹¤ì‹œ ë¶ˆëŸ¬ ë³¼ê¹Œìš”?

'ì œë¡œìƒ·'ì€ ì´ ì¹œêµ¬ì—ê²Œ ì•„ë¬´ íŒíŠ¸ ì—†ì´ ë°”ë¡œ ì§ˆë¬¸í•˜ëŠ” ê±°ì˜€ì£ ? 'í“¨ìƒ·'ì€ ë°˜ëŒ€ì˜ˆìš”. ì§ˆë¬¸í•˜ê¸° ì „ì— ëª‡ ê°€ì§€ íŒíŠ¸ë‚˜ ì—°ìŠµ ë¬¸ì œë¥¼ ë¨¼ì € ë³´ì—¬ì£¼ëŠ” ê±°ëë‹ˆë‹¤.

ìƒí™©ì„ í•˜ë‚˜ ìƒìƒí•´ ë´ìš”. ì—¬ëŸ¬ë¶„ì´ 'ë™ë¬¼ ì†Œë¦¬ ì–¸ì–´'ë¼ëŠ” ìƒˆë¡œìš´ ì•”í˜¸ë¥¼ ë§Œë“¤ì—ˆì–´ìš”. ì´ ì•”í˜¸ë¥¼ ì²™ì²™ë°•ì‚¬ AIì—ê²Œ ê°€ë¥´ì³ì£¼ê³  ì‹¶ì–´ìš”.

ê·¸ëƒ¥ "ì½”ë¼ë¦¬ëŠ” ë™ë¬¼ ì†Œë¦¬ ì–¸ì–´ë¡œ ë­ì•¼?" ë¼ê³  ë¬¼ì–´ë³´ë©´ AIëŠ” ì•Œ ìˆ˜ê°€ ì—†ê² ì£ ? ê·¸ë˜ì„œ íŒíŠ¸ë¥¼ ì£¼ëŠ” ê±°ì˜ˆìš”.

---

ì´ê²Œ ë°”ë¡œ í“¨ìƒ· í”„ë¡¬í”„íŠ¸ì˜ˆìš”!

ì—¬ëŸ¬ë¶„ì€ AIì—ê²Œ ì´ë ‡ê²Œ ë§í•´ìš”.

> "ì•ˆë…•! ì§€ê¸ˆë¶€í„° ë‚´ê°€ 'ë™ë¬¼ ì†Œë¦¬ ì–¸ì–´'ë¥¼ ê°€ë¥´ì³ ì¤„ê²Œ. ì˜ ë´ë´!"
>
> íŒíŠ¸ 1) 'ê°•ì•„ì§€'ëŠ” 'ë©ë©ì™ˆì™ˆ'ì´ë¼ê³  í•´.
>
> íŒíŠ¸ 2) 'ê³ ì–‘ì´'ëŠ” 'ì•¼ì˜¹ì‚¬ë¿'ì´ë¼ê³  í•´.
>
> íŒíŠ¸ 3) 'ë³‘ì•„ë¦¬'ëŠ” 'ì‚ì•½ë½€ì†¡'ì´ë¼ê³  í•´.
>
> "ì, ì´ì œ ì§„ì§œ ë¬¸ì œì•¼! ê·¸ëŸ¼ 'ì‚¬ì'ëŠ” ë­ë¼ê³  í• ê¹Œ?"

---

ëŠë‚Œì´ ì˜¤ë‚˜ìš”?

  * í“¨(Few): 'ëª‡ ê°œì˜'ë¼ëŠ” ëœ»ì´ì—ìš”.
  * ìƒ·(Shot): 'íŒíŠ¸' ë˜ëŠ” 'ì˜ˆì‹œ'ë¼ê³  ìƒê°í•˜ë©´ ë¼ìš”.

ì¦‰, 'ëª‡ ê°œì˜ íŒíŠ¸(ì˜ˆì‹œ)ë¥¼ ì£¼ê³  ë¬¼ì–´ë³´ëŠ” ê²ƒ'ì´ ë°”ë¡œ í“¨ìƒ· í”„ë¡¬í”„íŠ¸ëë‹ˆë‹¤.

ì—¬ëŸ¬ë¶„ì€ AIì—ê²Œ 3ê°œì˜ ì—°ìŠµ ë¬¸ì œ(íŒíŠ¸)ë¥¼ ë¨¼ì € ë³´ì—¬ì¤¬ì–´ìš”. ê·¸ë¬ë”ë‹ˆ AIëŠ” "ì•„í•˜! ë™ë¬¼ì˜ íŠ¹ì§•ì´ë‚˜ ì†Œë¦¬ë¥¼ í•©ì³ì„œ ë§Œë“œëŠ” ì•”í˜¸êµ¬ë‚˜!" í•˜ê³  ê·œì¹™ì„ ë°°ìš°ê²Œ ë¼ìš”.

ê·¸ë˜ì„œ AIëŠ” ì•„ë§ˆ ì´ë ‡ê²Œ ëŒ€ë‹µí•  ê±°ì˜ˆìš”.

> "ì•Œì•˜ì–´ìš”! 'ì‚¬ì'ëŠ” 'ì–´í¥ê°ˆê¸°'ë¼ê³  í•˜ë©´ ë˜ê² ë„¤ìš”!"

ì •ë¦¬í•˜ë©´, í“¨ìƒ· í”„ë¡¬í”„íŠ¸ëŠ” AIê°€ ì²˜ìŒ ë³´ê±°ë‚˜ ì–´ë ¤ìš´ ë¬¸ì œë¥¼ ë” ì˜ í’€ ìˆ˜ ìˆë„ë¡, ì¹œì ˆí•˜ê²Œ ëª‡ ê°œì˜ ëª¨ë²” ë‹µì•ˆ(ì˜ˆì‹œ)ì„ ë¨¼ì € ë³´ì—¬ì£¼ëŠ” ë°©ë²•ì´ì—ìš”. ì´ë ‡ê²Œ í•˜ë©´ AIê°€ ê·œì¹™ì„ ë” ë¹¨ë¦¬ ê¹¨ìš°ì¹˜ê³ , ìš°ë¦¬ê°€ ì›í•˜ëŠ” ì •ë‹µì„ ì²™ì²™ ë‚´ë†“ì„ ìˆ˜ ìˆë‹µë‹ˆë‹¤

### service/AiServiceFewShotPrompt.java 

``` java
@Service
@Slf4j
public class AiServiceFewShotPrompt {
  // ##### í•„ë“œ #####
  private ChatClient chatClient;

  // ##### ìƒì„±ì #####
  public AiServiceFewShotPrompt(ChatClient.Builder chatClientBuilder) {
    chatClient = chatClientBuilder.build();
  }

  // ##### ë©”ì†Œë“œ #####
  public String fewShotPrompt(String order) {
    // í”„ë¡¬í”„íŠ¸ ìƒì„±
    String strPrompt = """
        ê³ ê° ì£¼ë¬¸ì„ ìœ íš¨í•œ JSON í˜•ì‹ìœ¼ë¡œ ë°”ê¿”ì£¼ì„¸ìš”.
        ì¶”ê°€ ì„¤ëª…ì€ í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”.

        ì˜ˆì‹œ1:
        ì‘ì€ í”¼ì í•˜ë‚˜, ì¹˜ì¦ˆë‘ í† ë§ˆí†  ì†ŒìŠ¤, í˜í¼ë¡œë‹ˆ ì˜¬ë ¤ì„œ ì£¼ì„¸ìš”.
        JSON ì‘ë‹µ:
        {
          "size": "small",
          "type": "normal",
          "ingredients": ["cheese", "tomato sauce", "pepperoni"]
        }

        ì˜ˆì‹œ1:
        í° í”¼ì í•˜ë‚˜, í† ë§ˆí†  ì†ŒìŠ¤ë‘ ë°”ì§ˆ, ëª¨ì§œë ë¼ ì˜¬ë ¤ì„œ ì£¼ì„¸ìš”.
        JSON ì‘ë‹µ:
        {
          "size": "large",
          "type": "normal",
          "ingredients": ["tomato sauce", "basil", "mozzarella"]
        }

        ê³ ê° ì£¼ë¬¸: %s""".formatted(order);

    Prompt prompt = Prompt.builder()
        .content(strPrompt)
        .build();

    // LLMìœ¼ë¡œ ìš”ì²­í•˜ê³  ì‘ë‹µì„ ë°›ìŒ
    String pizzaOrderJson = chatClient.prompt(prompt)
        .options(ChatOptions.builder()
            .temperature(0.0)   // ë‹¤ì–‘í•œ ì‘ë‹µì´ í•„ìš” ì—†ìœ¼ë¯€ë¡œ 0.0ìœ¼ë¡œ ì„¤ì •
            .maxTokens(300)     // ìµœëŒ€ í† í° ìˆ˜ë¥¼ 300ìœ¼ë¡œ ì„¤ì •
            .build())
        .call()
        .content();

    return pizzaOrderJson;
  }
}

```

### controller/AiControllerFewShotPrompt.java

```java
@RestController
@RequestMapping("/ai")
@Slf4j
public class AiControllerFewShotPrompt {
  // ##### í•„ë“œ ##### 
  @Autowired
  private AiServiceFewShotPrompt aiService; 

  // ##### ë©”ì†Œë“œ #####
  @PostMapping(
    value = "/few-shot-prompt",
    consumes = MediaType.APPLICATION_FORM_URLENCODED_VALUE,
    produces = MediaType.APPLICATION_JSON_VALUE
  )
  public String fewShotPrompt(@RequestParam("order") String order) {
    //ì„œìˆ ì‹ ì£¼ë¬¸ì„ JSONìœ¼ë¡œ ë³€í™˜
    String json = aiService.fewShotPrompt(order);
    return json;
  } 
}

```

### ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤í–‰ í•˜ì—¬ í…ŒìŠ¤íŠ¸ í•´ë³´ê¸°
http://localhost:8080/few-shot-prompt ì„ ì‹¤í–‰í•˜ê³  ì œì¶œì„ í•˜ë©´ ìƒí™©ì— ë§ëŠ” ë¦¬ë·° ë¥¼ ì…ë ¥í•˜ê³  ì œì¶œì„ í´ë¦­í•˜ë©´ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì¶œë ¥ë©ë‹ˆë‹¤ 

![alt text](image-5.png)

ì‹¤í–‰ í™”ë©´ì„ ë³´ì‹œë©´ JSON ì‘ë‹µì´ ì¶œë ¥ë˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
JSONì„ ì¶œë ¥ ë  ìˆ˜ ìˆê²Œ 
stringai.js íŒŒì¼ì„ ì•„ë˜ì™€ ê°™ì´ ì¶”ê°€ í•˜ì‹œê³  ë‹¤ì‹œ ì‹¤í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤.

```js
// ##### JSONì„ ì´ì˜ê²Œ ì¶œë ¥í•˜ëŠ” í•¨ìˆ˜ #####
springai.printAnswerJson = async function(jsonString, uuid, chatPanelId) {
  const jsonObject = JSON.parse(jsonString);
  // ë“¤ì—¬ì“°ê¸°ë¥¼ 2ë¡œ ì„¤ì •í•´ì„œ ì´ì˜ê²Œ ë¬¸ìì—´ë¡œ ë§Œë“¬
  const prettyJson = JSON.stringify(jsonObject, null, 2);
  document.getElementById(uuid).innerHTML = "<pre>" + prettyJson + "</pre>";
  springai.scrollToHeight(chatPanelId);
};

```
ë‹¤ì‹œ ì‹¤í–‰ ê²°ê³¼ 
![alt text](image-6.png)

---

